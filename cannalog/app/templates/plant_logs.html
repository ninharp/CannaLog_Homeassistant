{% extends 'base.html' %}
{% block title %}Logbuch: {{ plant.pflanzenname }}{% endblock %}
{% block content %}
<div class="d-flex align-items-center justify-content-center mb-4" style="gap:1rem;">
    <a href="dashboard">
    <img src="static/assets/logo_small.png" alt="Logo" style="height:60px; width:auto; display:block; cursor:pointer;">
    </a>
    <h1 class="mb-0 fw-bold" style="font-size:2.2rem; line-height:60px;">Logbuch: {{ plant.pflanzenname }}</h1>
</div>
<div class="d-flex justify-content-between align-items-center mb-3" style="gap:1rem;">
    <div>
    <a href="plant/{{ plant.id }}" class="btn btn-secondary btn-sm">Zur√ºck</a>
    </div>
    <div class="d-flex gap-2">
    <a href="plant/{{ plant.id }}/logs/add" class="btn btn-success btn-sm">+ Neuer Eintrag</a>
    <a href="plant_actions/add?plant_id={{ plant.id }}" class="btn btn-info btn-sm">+ Aktion eintragen</a>
    </div>
</div>
<!-- entfernt: nicht mehr genutzt -->
<div class="table-responsive">
{% if entries %}
<table class="table table-striped align-middle">
    <thead>
        <tr>
            <th>Datum</th>
            <th>Notizen</th>
            <th>Messungen / Aktion</th>
            <th>Aktionen</th>
        </tr>
    </thead>
    <tbody>
    {% for entry in entries %}
        <tr>
            <td>{{ entry.date.strftime('%d.%m.%Y') }}</td>
            <td>
                {% if entry.type == 'log' %}
                    {{ entry.obj.notes|default('-') }}
                {% elif entry.type == 'action' %}
                    {{ entry.obj.notes|default('-') }}
                {% endif %}
            </td>
            <td>
                {% if entry.type == 'log' %}
                    {% if entry.obj.measurements|length > 0 %}
                        <span class="badge bg-info text-dark">{{ entry.obj.measurements|length }}</span>
                        {% set type_icons = {
                            'hoehe': '‚ÜïÔ∏è',
                            'tds': 'TDS',
                            'ph': 'pH',
                            'ec': '‚ö°',
                            'wassertemperatur': 'üå°Ô∏è',
                            'ppfd': '‚òÄÔ∏è'
                        } %}
                        {% for m in entry.obj.measurements %}
                            <span title="{{ m.type }}">{{ type_icons.get(m.type, 'üî¨') }}</span>
                        {% endfor %}
                    {% else %}
                        <span class="text-muted">-</span>
                    {% endif %}
                {% elif entry.type == 'action' %}
                    <span class="text-muted">-</span>
                {% endif %}
            </td>
            <td>
                <!-- Aktionen-Buttons hier, falls ben√∂tigt -->
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>Keine Log-Eintr√§ge vorhanden.</p>
{% endif %}
</div>
{% endblock %}
